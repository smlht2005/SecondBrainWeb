# 🚀 Zeabur 部署流程圖

## 視覺化部署步驟

```
┌─────────────────────────────────────────────────────────────────┐
│                     🎯 開始 Zeabur 部署                          │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  步驟 1: 登入 Zeabur                                             │
│  ✓ 訪問 https://zeabur.com                                       │
│  ✓ 使用 GitHub 帳號登入                                          │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  步驟 2: 創建專案                                                │
│  ✓ Dashboard → New Project                                      │
│  ✓ Deploy New Service → Git                                     │
│  ✓ 選擇 smlht2005/SecondBrainWeb                                │
│  ✓ 選擇 main 分支                                               │
│  ✓ 點擊 Deploy                                                  │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  步驟 3: 配置環境變數 ⚙️                                         │
│  ┌──────────────────────────────────────────┐                   │
│  │ 服務詳情 → Variables → Add Variable      │                   │
│  ├──────────────────────────────────────────┤                   │
│  │ NODE_ENV = production                    │                   │
│  └──────────────────────────────────────────┘                   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  步驟 4: 配置 Volume 💾 (重要！)                                 │
│  ┌──────────────────────────────────────────┐                   │
│  │ 服務詳情 → Volumes → Add Volume          │                   │
│  ├──────────────────────────────────────────┤                   │
│  │ Name: secondbrain-data                   │                   │
│  │ Mount Path: /home/node/.openclaw/...     │                   │
│  │ Size: 1 GB                               │                   │
│  └──────────────────────────────────────────┘                   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  步驟 5: 等待建置 ⏳                                             │
│  ┌──────────────────────────────────────────┐                   │
│  │ ⚙️  Cloning repository...                │                   │
│  │ 🐳 Building Docker image...              │                   │
│  │ 📦 Installing dependencies...            │                   │
│  │ 🔨 Running npm run build...              │                   │
│  │ ✅ Deployment successful!                │                   │
│  └──────────────────────────────────────────┘                   │
│  預計時間: 2-4 分鐘                                              │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  步驟 6: 獲取 URL 🌐                                             │
│  ┌──────────────────────────────────────────┐                   │
│  │ 服務詳情 → Domain                        │                   │
│  │ https://secondbrainweb-xxxx.zeabur.app   │                   │
│  └──────────────────────────────────────────┘                   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  步驟 7: 驗證部署 ✅                                             │
│                                                                  │
│  ┌─────────────────────────────────────────────────────┐        │
│  │ 健康檢查                                             │        │
│  │ curl https://your-app.zeabur.app/health            │        │
│  │ ✅ {"status":"healthy"}                             │        │
│  └─────────────────────────────────────────────────────┘        │
│                                                                  │
│  ┌─────────────────────────────────────────────────────┐        │
│  │ API 測試                                             │        │
│  │ curl https://your-app.zeabur.app/api/brain/files   │        │
│  │ ✅ [] (空陣列，尚未上傳資料)                        │        │
│  └─────────────────────────────────────────────────────┘        │
│                                                                  │
│  ┌─────────────────────────────────────────────────────┐        │
│  │ 前端測試                                             │        │
│  │ 在瀏覽器訪問 https://your-app.zeabur.app            │        │
│  │ ✅ 頁面正常載入                                      │        │
│  │ ✅ CSS/JS 正確載入                                   │        │
│  │ ✅ 無 CORS 錯誤                                      │        │
│  └─────────────────────────────────────────────────────┘        │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
                ┌─────────────┴─────────────┐
                │                           │
                ▼                           ▼
┌───────────────────────────┐  ┌──────────────────────────┐
│  可選: 上傳初始資料 📁     │  │  可選: 綁定自訂網域 🌍    │
│                           │  │                          │
│  使用 Web 終端:           │  │  Dashboard → Domains     │
│  cd /home/node/...        │  │  → Add Custom Domain     │
│  mkdir -p brain memory    │  │                          │
│  cat > brain/welcome.md   │  │  更新 CORS 白名單:       │
│  ...                      │  │  修改 server/index.ts    │
└───────────────────────────┘  └──────────────────────────┘
                │                           │
                └─────────────┬─────────────┘
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                     🎉 部署完成！                                │
│                                                                  │
│  您的應用現在已在線上運行：                                       │
│  🌐 https://your-app.zeabur.app                                 │
│                                                                  │
│  下一步建議：                                                    │
│  • 上傳知識庫內容                                                │
│  • 定期監控應用狀態                                              │
│  • 備份重要資料                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🔀 決策樹：遇到問題時

```
                        部署過程中遇到問題？
                              │
              ┌───────────────┼───────────────┐
              │               │               │
              ▼               ▼               ▼
        建置失敗？      靜態資源錯誤？     CORS 錯誤？
              │               │               │
              ▼               ▼               ▼
    查看 Logs 標籤    確認建置成功    確認 NODE_ENV
    檢查 Dockerfile   檢查 dist/      檢查 allowedOrigins
              │               │               │
              └───────────────┼───────────────┘
                              ▼
                    參考 ZEABUR_DEPLOYMENT_GUIDE.md
                        故障排除章節
```

---

## 📊 時間線估算

| 階段 | 預計時間 | 說明 |
|------|---------|------|
| 登入和授權 | 1 分鐘 | GitHub OAuth |
| 創建專案和服務 | 30 秒 | 選擇 Repository |
| 配置環境變數 | 15 秒 | 設定 NODE_ENV |
| 配置 Volume | 30 秒 | 設定掛載路徑 |
| **建置和部署** | **2-4 分鐘** | Docker 建置 |
| 驗證測試 | 1 分鐘 | curl 測試 |
| **總計** | **約 5-7 分鐘** | - |

---

## ✅ 檢查清單（可打印）

部署前：
```
□ GitHub 代碼已推送（Commit: fb52fc2）
□ Zeabur 帳號已登入
□ 已準備好配置環境變數
```

配置階段：
```
□ 服務已創建並連接到 GitHub
□ 環境變數 NODE_ENV=production 已設定
□ Volume 已配置（Mount Path 正確）
```

驗證階段：
```
□ 建置日誌無錯誤
□ 服務 URL 可訪問
□ /health 返回 200 OK
□ /api/brain/files 返回 200 (可能是空陣列)
□ 前端頁面正常載入
□ CSS/JS 文件正確載入（檢查 Network 標籤）
□ Console 無 CORS 錯誤
```

完成：
```
□ 記錄服務 URL
□ （可選）上傳初始資料
□ （可選）設定監控告警
□ 🎉 部署成功！
```

---

## 🆘 快速幫助

### 問題：建置失敗
```
→ 查看步驟：
  1. Zeabur Dashboard → Logs
  2. 查找紅色錯誤訊息
  3. 參考 ZEABUR_DEPLOYMENT_GUIDE.md 故障排除
```

### 問題：靜態資源 404
```
→ 檢查項目：
  1. npm run build 是否成功？
  2. dist/ 目錄是否存在？
  3. server/index.ts 路徑是否正確？
```

### 問題：CORS 錯誤
```
→ 確認配置：
  1. NODE_ENV=production 已設定？
  2. allowedOrigins 包含您的網域？
  3. 靜態資源路由是否在 CORS 之前？
```

---

**更新時間**: 2026-02-05 18:30  
**文檔類型**: 流程圖和決策樹
